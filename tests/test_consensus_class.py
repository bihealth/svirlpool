import json
from gzip import open as gzip_open
from gzip import open as gzopen
from pathlib import Path

import cattrs
from pysam import AlignedSegment, AlignmentFile

from svirlpool.localassembly import consensus_class
from svirlpool.util.datatypes import Alignment
from svirlpool.util.util import get_interval_on_ref_in_region

DATA_DIR = Path(__file__).parent / "data"

# files: INV.1.aln.json.gz  INV.1.consensus.json.gz  INV.2.aln.json.gz  INV.2.consensus.json.gz
# to save _process_alignment_file_for_core_intervals debug data:
# if consensus_obj.ID == "11.0":
#     cons = consensus_obj.unstructure()
#     alignment.unstructure()
#     consensus_path = "/data/cephfs-1/work/groups/cubi/users/mayv_c/production/svirlpool/tests/data/consensus_class/INV.1.consensus.json"
#     with open(consensus_path, "w") as debug_f:
#         json.dump(cons, debug_f, indent=4)
#     alignment_path = "/data/cephfs-1/work/groups/cubi/users/mayv_c/production/svirlpool/tests/data/consensus_class/INV.1.aln.json"
#     with open(alignment_path, "w") as debug_f:
#         json.dump(alignment.unstructure(), debug_f, indent=4)

# if consensus_obj.ID == "11.1":
#     cons = consensus_obj.unstructure()
#     alignment.unstructure()
#     consensus_path = "/data/cephfs-1/work/groups/cubi/users/mayv_c/production/svirlpool/tests/data/consensus_class/INV.2.consensus.json"
#     with open(consensus_path, "w") as debug_f:
#         json.dump(cons, debug_f, indent=4)
#     alignment_path = "/data/cephfs-1/work/groups/cubi/users/mayv_c/production/svirlpool/tests/data/consensus_class/INV.2.aln.json"
#     with open(alignment_path, "w") as debug_f:
#         json.dump(alignment.unstructure(), debug_f, indent=4)


def load_test_data(_name: str) -> consensus_class.Consensus:
    consensus_path = DATA_DIR / "consensus_class" / _name # INV.110.consensus.json.gz or INV.111.consensus.json.gz
    # load the gzipped json dumped structured objects
    with gzip_open(consensus_path, "rt") as f:
        consensus_data = f.read()
        consensus: consensus_class.Consensus = cattrs.structure(
            json.loads(consensus_data), consensus_class.Consensus
        )
    return consensus

# This is used in the tests
def load_alignments(path: Path) -> list[Alignment]:
    with gzopen(path, "rt") as f:
        data = json.load(f)
    alignments = cattrs.structure(data["alignments"], list[Alignment])
    return alignments




def test_get_interval_on_ref_in_region():
    alignments: list[Alignment] = load_alignments(
        DATA_DIR / "signalprocessing" / "alignments_to_rafs.dummy_inversion.json.gz"
    )
    # 2000M4000H - forward
    result_a = get_interval_on_ref_in_region(
        a=alignments[0].to_pysam(),
        start=1000,
        end=3000
    )
    expected_a = (1000, 2000)
    assert expected_a == result_a, f"got {result_a}, expected {expected_a}"
    # 2000H2000M2000H - reverse
    result_b = get_interval_on_ref_in_region(
        a=alignments[1].to_pysam(),
        start=1000,
        end=3000
    )
    expected_b = (3000, 4000)
    assert expected_b == result_b, f"got {result_b}, expected {expected_b}"
    # 4000S2000M - forward
    result_c = get_interval_on_ref_in_region(
        a=alignments[2].to_pysam(),
        start=3000,
        end=5000
    )
    expected_c = (4000, 5000)
    assert expected_c == result_c, f"got {result_c}, expected {expected_c}"

    
def test_get_consensus_core_alignment_interval_on_reference_inv():
    # test 11.0 and 11.1
    alignments_path = DATA_DIR / "consensus_class" / "inv.11.bam"
    alignments = list(AlignmentFile(str(alignments_path)).fetch())
    # test 11.0
    alignments_110 = [aln for aln in alignments if aln.query_name == "11.0"]
    
    cons1 = load_test_data("INV.110.consensus.json.gz")
    # for each alignment, find the core interval on reference
    results = {i: consensus_class.get_consensus_core_alignment_interval_on_reference(
        consensus=cons1,
        alignment=alignments_110[i]) for i in range(len(alignments_110))}
    for i,res in results.items():
        print(f"Alignment {i} core interval on reference: {res}")
    # print the consenuss objects
    print(cons1)


test_get_consensus_core_alignment_interval_on_reference_inv()
print(len('atgtttttagtatgagttagtctgtttagcgaatgcatgggatgaatgtgattcagctccttgcacatcttgcacccccagtcccctctggttcctctgcttagtgctcccaggtaggaagaggagactggaagcccctgggactctcgagaaatgccacctggtttccttgcagcaagcgcagcgcaatttgccaagtattaagctaactcccctgaaagcctgttgctctgcagcccctataactagcagcatctgagccatccccaaggtttgggccccttgtctcctgtctaggcagggctccattcatggcactcgtgaggacaacttgttgggctatcaaatgtcactctgttactcccatgcagaaggcaggtttgtgaagcaatgatgagttattccaagcaaatgccagggctggacagggcgttgatgctggaatgcagggtgagagacattgccagcttccatctcaccaccaaaagtgcgagggtgcatctgccccatacactggcccagccccttcaggtcctgtgcctccaagctgtggaggaaaggacacacggccttcatgtgctcaggcctgtggcagtatttttttgattgaagggagaactagatactacacttgagccttctatataatgctattttgcaaggtgcaggtcatttgattgtgaggcttgctatgctgttagtagcacaaaatgtaagtcaatctaagggtggtgtgacaagatcttggaagatttgtgttggtatccaaacagaatttaccagcttatttcataaaaaggaaaaaggcatttcttagtcattgggtacccactgaggaccatctgattgcttatcttcatactcagaacagtgttaggatgactacattatgatagtgccacatcccttgaagaatgagatcttggcttaaacgaggttacataacctgttcaaaaatcacatgaatggccaaagcaagtgaaacaactcaaatttcaacctggaaataggacactgaaaataaactcatataaattttttatccaaaaattctaacttgatgaatttaccaattaagtcattttatgtctttaaattacatcactatcacttattggatgaatgttcacctcatcaacaacataatctcactctttcaagacataataattttcctctaaagaaaacaacttatatatttagtggatctcgtcatgaaagaaaaaaagaatatttagaaaaaaacatacacaaggtaaaattggaaataaaatcctgccggatggagtgattgcacgatcagaaacaaagggataattcccccacactgcttaagacagctcctcaagtgagataagaaaaagaccgacagtgtgacgcagtggctcatgcctgtaatcccagcactttgggagcccgaggtgggcggatcacctgaggtcgggagtttgagaccagcctgaccaacatggagaagcccggtctctactaaaaatacaaaattagctggaggtggcgcatgcctgtaatcccagctacttgggaggctgaggcaggagaatcgcttgaacccaggaggcggaggttgcggtgagccgagatcgtgccattgcactccagcctgtgcgacaagagcaaaactccatctaaaaaaaaaaaaaaagacctggacatcccctagaataacaaacgtcgagtctcaccaagcatctcctagaataaatggacagagactccaacgcacgtcaataggcatccactggaacaataaacgtggagctcaagtgggtgtcccctggaacagtgaacgtcaaacttagtgggcgtcccttagaataatgaataggaagctcaacgggcagtctcagaaaatcaaacccacgtggccccgggtggccagaattgggtaatatcttcccaccataaaaaggttcaaccaatacaaacagtgatgcatcatgttatgaaataccatgcagctgctttttacaattttcttattttgaggtaagtagaggctcaccggaggatgtgcaactcacaggaggatgtgcagctcacaggaggatgcccacagagtgaagagggattccatgtgcccttcactcagattccctgaaggcaacgtccgtaatgatgctaggacaaaagaaaaaccaggaggttgatgttggtaccatacaattaactagactacagcttttcttggatttttccatttatttcaggcactcatttttatttttatttttggcatgcctttctgtatagttctataacttttaaatatatatcctcatctatatttctatgacatttaatcacatgtacaagctcatatcaactccaccataatcaacatacaaaacttttccaccaccacagagaatgcagctattctttagataggttttgttttcattctgttagttttctgacttcaccatttatttatttctgtcctttagttagttgcatggctgctttcgtatttgcttacctatagtttttaatttaaccaaaaatcgagctcaattcttcttcaagatcttttttttttttttttttttttttttttttttttttgagacggagtctcgctctgtcgcccaggctggagtgcagtggcgcgatctcagctcactgcaagctccgcctcctgggttcacgccattctcctgcctcagcctcccgagtagctgggactacaggcgcccgccaccacgcccggctaattttttgtatttttagtagagacggggtttcaccgtgttagccaggatggtctcgatctcctgacctcgtgatccgcccgcctcggcctcccaaagtgctgggattacaggcgtgagccaccgcgcccggccttcttcaagatcttaagactgcttttctttttccaaagcctactggccacactctgggaagaattttgaacaagtattcgcttgaaggagaatcactggtctagcttaatggtggtgccttccaggtatgtgagtacctaattgcagcattttgagcactaactaggtacatgggaaattgtactagtttattttatttttctgagtgaagcaagatcaacacagtgacttatttgggataaattagtaagtggcagaaatggaactggatagccttcccccatactttactttcctgtaccatccacttcacatatgagctttaccataaccatagtactcaaaagaaaaacagatgaaaactatatcttaaaatataatttgatatgggcccacaaaataaaagcatgttataaataatgaggattttccaaagaagatggaaattcttataaagttcatattaataaatggagtctctatagtagctctaaatgtccctgttatcaaattcatgttaaattctatccaaaatgtttctcatataatcattactgattagtatttttagttattttttactctttaaactctattcccttgctttttggactgatcaatacacttctgttttgaaaaggagggtcaagtggtggagagggtttgaggctgggaataaattatgctggctgtggcgggaaactatgaaaagccagagccagcctgaaataggaattcctgccagcccatgcctgtgagcagggaaggggaacattccacagcacacctggcctccatgaaatatgatctgaatggctgtagcccacctggggatccgttgagagccctggttccaggattacacctgcaaagccctcctcccccaacaggacaatgcaagccattgaggtttgtctgtcatcaacaggtaagtacccacctgacctgcaaatccagggcgtcgacctagggcacatttcaatccaaattcttatgaagtgtattggccacatttgacatagactaatccccagaaacagaggaccataggaattaatgcctttttctgctagtctaggcattcaatgtaaagataaaaatttattaaatctgtgtggttctagcaaacagttttcattaatatctaatccatcaatgctttttattagtttgtaagtgctctacaagcctgctgtataaccctgtgaatttacataaggcacaaaagtcttaagagataaataagcaaaataaagaaaaggcccacacaggtattttcagtgtataagctgaaggctaatcagtgagttagtgtcttcagatgtccactgaatcactcattcttttgaagcaaaatctataatacacgaaatatctttgttgtaactgaagacaactaagtaacgagaagcagaaaatgtcctctcaccacccacatcttgccccaggtgacctgagaaattgcatcttgtagaaggaaggcaacatgttacttacatgccccagggaggggggtaacccgggattctccctttctcgtgtaacattcagccgagctacctggacatactccaaacatgtcatgattttagattttgtataaaaatactcccaaagatacagcctcgctcaaagccaggatccacctcccgaggactgacagagagaggatgcctccggcccagagcccacagcagaggcctcactcacgtgcgctctgggccagagcaggcctcaggcacttcagctccagggagaccggccagcaaggtcgggtatttggaaggagctcaggaagcgttcccctgcaggaagccgaaagcaggagagacaccaggggccgggagatggaattggaatctgcagcattcttcaggggcggaagccccaagccgtccatgtgaggctgttggccaaggggctgaggggagggcacgaagtaactcactagagacaagacacaggtgagtcctccaggcacccactcacaggaacagcgtgaaggtcagctttcagaaacttcagtaattttaaaaggatctgaagaggactttaaaaatatctaagatccttaaagggatctggtgggaagagactccacaaaaacacacaggacatgatgaggtgaggagtgcaaatcagggcctaattgctgatgactcaactgcaaaaataaatattttctcaaaggcaatgaaatagcattttcacaggactcaggaaaaatgactcaacctagaattctatacccacataaaatatcttccagtagagaaagttaattgcagcattttcgggtagggaaactgaatttaaaacctgcaagcactgatgaaaggtttattaatacacgtagttcagcagaagaaaacagccttcaggaataagagggaaaacagccgaagctctcagcaaaatggccttgtaagctcttggcaaagctgatttctatgtcttatttgttaagggggaacgtacatttcaggtatcccaggtgcagaagaccgaggggttccaaggagggttaaactgtggcaagaccctttgttgaaaggagagcagagataatgaataactcaaaactttgtaagataatataaaattgaatagcatactaagatgtttaggtaatctttaataggatgtaaaactataaacatccaaacatccttcaaagggaatgagctaaagagataaaacttttccgttccaacacaagccagaagaagggaagaggagaaaaacaaagcaaagtaagaatagaatgcaaattaaaattattctaattgaatcaatagtcacaataaatacacggagagttatcttaccttgtacaagacagaggttaggagattgaaatttaaaatccagttttatgctgtttatgggggacattcttaaaacaaagaaacaatttgaaactaagaggaagggaaatgatagtgaaactctgatataccaatattaatatcaaataactaaaatatctggtaatcacactaacaggtaagagggtattaagagttgagttgtgtcctgttccccagaaaaaggatatgttgaaattctaaccctcagtacttcaaaatgtggtaatatttaaaattgtatttgattgtttggaactatattattatttggaaatagagttttcacagataaccaagctaaaacgaggtcacatgcgtgtctggatccagcgtgacaaaagtatttatttctgcagatgaatcatcagcaattaggccctgatttgcactcctcacctcatcatgtcctgtgtgtttttgtggagtctcttcccaccagatccctttaaggatcttagatatttttaaagtcctcttcagatccttttaaaattactgaagtttctgaaagctgaccttcacgctgttcctgtgagtgggtgcctggaggactcacctgtgtcttgtctctagtgagttacttcgtgccctcccctcagccccttggccaacagcctcacatggacggcttggggcttccgcccctgaagaatgctgcagattccaattccatctcccggcccctggtgtctctcctgctttcggcttcctgcaggggaacgcttcctgagctccttccaaatacccgaccttgctggccggtctccctggagctgaagtgcctgaggcctgctctggcccagagcgcatgtgagtgaggcctctgctgtgggctctgggccggaggcgtcctctctctgtcagtcctcgggaggtggatcctggctttgagcgaggctgtatctttgagaatatttttatacaaaatctaaaatcacgacatgtttggagtatgtccagtaggtcggctcaatgttacactagaaagggagaatccgtgggtgcagacaggtgctgcgggaggaggatgtggaggcagcgggtcgccgggaccaccaggagctagagagaggccggagcagaccccgccccgggcctgtggagggagccaggccctgccccgcagcacctgcgttttggctctggcctccggaactgtgagagaagagatttctgtgaagacaccggctctggggtgctttgctctggcagcagtaggaagccagcgcagagatcagtatgatgcgtctatttaacagcgtccccgcagaatgtgcagaggaaactccagaatgcaaaagtcgggaggtgacagagggagaaggtttacctataacttcttgcgcaaaaacataaattgcaaattaacaacaacaagaggtatggttgaacggcacgattctgagcttgattgatgtgtgtgtcagaaggcaggcctctgcgtgagtagacactgaacacggtttccacgcggtgtattaaacggcccttgcaaatgcctcacagtaacagtgacttgggcaagagaaacccatggaggcaaaacctagtggatgaaagtttcacgagaaacgaggtattaaaatcatctcaagccacttgccgccgtttcgcacctgtaggcccttttccgagtgatagcactgcccagtcgcattcgcgtgccatgggcaccatgtggttctgtggggtgtgccaagggccctgcaccagtctcagtcccctgcacctaaacaccaggacatcagcagagcccgggtgagaggaagctgaccccggaactggcctgcaagcctctgagatgccagcaactgcagagttcacatctgtttgcctggggttgtcagagaacaaagccccagcagaggtcatttcaaggtcatgggaggaaagggaagaccaagccaccattccaggcagaaggaaactggccgtgacaagacatggaatgcatggtcctgagtcaggggctgtgcagaaagaaggggatggaccgacggctgctgcaggtctggttggctggtgggtttcgggtttccctataagtgctatggaaaccacctacggtatgccagcagggcctgtgactcgatggtagtatcgcgtccacgttgatcgctttggggtactgggattacgtggctgtaagtccaggttttagaaatgagagccacatctgccacccttggctgttattcacaagtcatgaatcgaggcagccgccattctttttgtttttttttttttttaattttactttaagctctggggtccatgtgcagaacgtgcaggtttgctacattaagtatacatgtgccacggtggtttgctgcacctgtcaacccaacatgctggttttaaccccgcatgaattagatatttgtcctaatgctctcccttccctttcgccccacacaccgacaggccccggtgtgtgatgttcccctccctgcgtccatgtgttctccttgttcaactcccacttatgagtgagaacatgcagtgtttggttttctgctccgaggaagcctctattctacaagatagaatgagagttccactgggcgctggcagaacagtgggttttgtaaggtggggaccaggaaacagaataggaaacaaaaatgacgggtaacctcaggttacttcaggttcccctttcccttacagggaaaagcagaaggggcttcctttctgcgctgactcaggtctggaatctcctgtggtcaggaaaatctggactgttttgtgatctagatgcttccttaatgtttcagcttgacttagcgtgagtgactccattttggtttgatctggtctgttgggaccaagtgtaggggctcattccaaaacaatggcctcccacaatttttgtttaacaaggttcaaaaagaataatgaagtgtgtgtgtgccgtgagcgcctgtgctgtgcgagcacacgtatgcacatcagagaaagccagtggatgagacaaatgtggtgaaaagttaacagctgaagatgggcatataggagttctatgcactgtcctctcaccttttctgtaaattagacattatttcaaataaaaaagtcaaataattaaatgcaacaaagtaataagacaatataatataaacattaaaattgatgtgaaaagaatattgaaattggccaaaaagaaagtcttgacaaattccaaagataatatatcatacaaaccatatttgtcagctacagtgaaattatactggcaattaactttaaccaaacaacatcaaatgttcaggaagtaagaaaacacatctctgagttaatcattggttaaagaagaaattacagagtgaattacaaaacatttataactgagtgataatgaaaactctagctatcaaaatttgtgggctgggcgtggtaactcatgcctgtgattctaactgtttgggaggccgagacaggtggatcgcatgagctcaggagtttgagacaagcctgagtaacagagtgagaccccgtatctacgagagatacaaacattagccacgtgtggtggtagacacctgtcgtcccagctactcaggaggctgaggtgggagaatcatctgagcccagggtgttgaggctgcagtgagtcgtgatcaagccactgcactccagccttggttacagagtgagctagaccctgtctcaacaaacaaacaaacaaacaaacaaaaaatttgtaaagtgcaaataggaggtaatcacaggaaaatgaacaccatttgatgtatctattggaaaagaaggcagatgggaaacaaattaatgttcatctcaatatgtcgaagccaggcgcggtggctcacgtctgtaatcccagcactttgggaggctgaggcaggtggttcacctgaggtcaggagttcaagaacagactggccaacatggtaaaacccggtctctactaaaaatacaaaaaaagtaaccgggcgtggtggcaggcacctggaatctcagctactcaggagactgaggcaggagacttgcttgaacccagaaggcagaggttgcaatgagcctagatcgcttcactgcactccagcctgggcaacaagagcaaaactctgcctcagaaaagaaaagaaaagaaaaaaaaattggaaaaaatagatgcttttcctcaatcatctgattagcttctgacagcaatgctgaacagaaacaagactgtggcagggaggcttcggcgcgtacatctcgtctgacagggatgcaaatattccatttctctccttgccttggtttctcagctcagcccacatgtgtttttcctgtgggacaggtcccttctgcacacattttgttcaccaacagcagcttaagctttatcttttttcttctgaattcttgttctacttgtactgattttctaatttatttgtttttatcctaggatattttgtaagctatgaaacagttttatatgagactgccattgactgaggaaaaaaatgtgactttgacagaaaagtactccataaatatttgttaaatgcaaatgagccacactaattaagtcaggaaatgataaaagaacttgccacattattatttttcattctttagttatcagcacctttaattgctacctctgagaatcttcatgtaacttctctaagagaaaatatggaaagacttataaagctagtgtgtgttttcacaaatcaaattttcaggactcactttggcccaagttaagcaatgctaagtcatgaatgatttctaagaaccctctgaacactgccttatttgcgtggcctaaatggggctgaataaacgttgcaaccagctttccctcaaatgtccccatgatgttttgagcattgtgaatgcaccaagtcctcacacacgtttcattaggcagcatctctctgccccttaatctttaaatgcaagtgggtttcaaaggaaattatgattcatatgtttctaattcctttattcttactgaaatgtatctaaatattgctttgtaatagttatctgatgcccaaaagcttttgaaattttaactattttcccaaagtcagggtcttatgtttggaaaaacaatgagctctaaaccctacatatttcaactctgaactcatgaggtttcagatgacttttctacatgagcaaatgccattctctacaaatatctgaggattaaatcaataaattcccttttttttccccatggcagtaggtaaggaagaagagattcagaggaagaagagggcctcttagttttgttttaagacattgcaatagtttgggtgaaaagaaaatagagagtagtttgagccactctgtgtgatctcgttgggcctagaatggtgatgg'))

#%%


# consensus_class.Consensus(
#     ID='11.0',
#     crIDs=[11],
#     original_regions=[('6', 169093103, 169094952)],
#     consensus_sequence='atgtttttagtatgagttagtctgtttagcgaatgcatgggatgaatgtgattcagctccttgcacatcttgcacccccagtcccctctggttcctctgcttagtgctcccaggtaggaagaggagactggaagcccctgggactctcgagaaatgccacctggtttccttgcagcaagcgcagcgcaatttgccaagtattaagctaactcccctgaaagcctgttgctctgcagcccctataactagcagcatctgagccatccccaaggtttgggccccttgtctcctgtctaggcagggctccattcatggcactcgtgaggacaacttgttgggctatcaaatgtcactctgttactcccatgcagaaggcaggtttgtgaagcaatgatgagttattccaagcaaatgccagggctggacagggcgttgatgctggaatgcagggtgagagacattgccagcttccatctcaccaccaaaagtgcgagggtgcatctgccccatacactggcccagccccttcaggtcctgtgcctccaagctgtggaggaaaggacacacggccttcatgtgctcaggcctgtggcagtatttttttgattgaagggagaactagatactacacttgagccttctatataatgctattttgcaaggtgcaggtcatttgattgtgaggcttgctatgctgttagtagcacaaaatgtaagtcaatctaagggtggtgtgacaagatcttggaagatttgtgttggtatccaaacagaatttaccagcttatttcataaaaaggaaaaaggcatttcttagtcattgggtacccactgaggaccatctgattgcttatcttcatactcagaacagtgttaggatgactacattatgatagtgccacatcccttgaagaatgagatcttggcttaaacgaggttacataacctgttcaaaaatcacatgaatggccaaagcaagtgaaacaactcaaatttcaacctggaaataggacactgaaaataaactcatataaattttttatccaaaaattctaacttgatgaatttaccaattaagtcattttatgtctttaaattacatcactatcacttattggatgaatgttcacctcatcaacaacataatctcactctttcaagacataataattttcctctaaagaaaacaacttatatatttagtggatctcgtcatgaaagaaaaaaagaatatttagaaaaaaacatacacaaggtaaaattggaaataaaatcctgccggatggagtgattgcacgatcagaaacaaagggataattcccccacactgcttaagacagctcctcaagtgagataagaaaaagaccgacagtgtgacgcagtggctcatgcctgtaatcccagcactttgggagcccgaggtgggcggatcacctgaggtcgggagtttgagaccagcctgaccaacatggagaagcccggtctctactaaaaatacaaaattagctggaggtggcgcatgcctgtaatcccagctacttgggaggctgaggcaggagaatcgcttgaacccaggaggcggaggttgcggtgagccgagatcgtgccattgcactccagcctgtgcgacaagagcaaaactccatctaaaaaaaaaaaaaaagacctggacatcccctagaataacaaacgtcgagtctcaccaagcatctcctagaataaatggacagagactccaacgcacgtcaataggcatccactggaacaataaacgtggagctcaagtgggtgtcccctggaacagtgaacgtcaaacttagtgggcgtcccttagaataatgaataggaagctcaacgggcagtctcagaaaatcaaacccacgtggccccgggtggccagaattgggtaatatcttcccaccataaaaaggttcaaccaatacaaacagtgatgcatcatgttatgaaataccatgcagctgctttttacaattttcttattttgaggtaagtagaggctcaccggaggatgtgcaactcacaggaggatgtgcagctcacaggaggatgcccacagagtgaagagggattccatgtgcccttcactcagattccctgaaggcaacgtccgtaatgatgctaggacaaaagaaaaaccaggaggttgatgttggtaccatacaattaactagactacagcttttcttggatttttccatttatttcaggcactcatttttatttttatttttggcatgcctttctgtatagttctataacttttaaatatatatcctcatctatatttctatgacatttaatcacatgtacaagctcatatcaactccaccataatcaacatacaaaacttttccaccaccacagagaatgcagctattctttagataggttttgttttcattctgttagttttctgacttcaccatttatttatttctgtcctttagttagttgcatggctgctttcgtatttgcttacctatagtttttaatttaaccaaaaatcgagctcaattcttcttcaagatcttttttttttttttttttttttttttttttttttttgagacggagtctcgctctgtcgcccaggctggagtgcagtggcgcgatctcagctcactgcaagctccgcctcctgggttcacgccattctcctgcctcagcctcccgagtagctgggactacaggcgcccgccaccacgcccggctaattttttgtatttttagtagagacggggtttcaccgtgttagccaggatggtctcgatctcctgacctcgtgatccgcccgcctcggcctcccaaagtgctgggattacaggcgtgagccaccgcgcccggccttcttcaagatcttaagactgcttttctttttccaaagcctactggccacactctgggaagaattttgaacaagtattcgcttgaaggagaatcactggtctagcttaatggtggtgccttccaggtatgtgagtacctaattgcagcattttgagcactaactaggtacatgggaaattgtactagtttattttatttttctgagtgaagcaagatcaacacagtgacttatttgggataaattagtaagtggcagaaatggaactggatagccttcccccatactttactttcctgtaccatccacttcacatatgagctttaccataaccatagtactcaaaagaaaaacagatgaaaactatatcttaaaatataatttgatatgggcccacaaaataaaagcatgttataaataatgaggattttccaaagaagatggaaattcttataaagttcatattaataaatggagtctctatagtagctctaaatgtccctgttatcaaattcatgttaaattctatccaaaatgtttctcatataatcattactgattagtatttttagttattttttactctttaaactctattcccttgctttttggactgatcaatacacttctgttttgaaaaggagggtcaagtggtggagagggtttgaggctgggaataaattatgctggctgtggcgggaaactatgaaaagccagagccagcctgaaataggaattcctgccagcccatgcctgtgagcagggaaggggaacattccacagcacacctggcctccatgaaatatgatctgaatggctgtagcccacctggggatccgttgagagccctggttccaggattacacctgcaaagccctcctcccccaacaggacaatgcaagccattgaggtttgtctgtcatcaacaggtaagtacccacctgacctgcaaatccagggcgtcgacctagggcacatttcaatccaaattcttatgaagtgtattggccacatttgacatagactaatccccagaaacagaggaccataggaattaatgcctttttctgctagtctaggcattcaatgtaaagataaaaatttattaaatctgtgtggttctagcaaacagttttcattaatatctaatccatcaatgctttttattagtttgtaagtgctctacaagcctgctgtataaccctgtgaatttacataaggcacaaaagtcttaagagataaataagcaaaataaagaaaaggcccacacaggtattttcagtgtataagctgaaggctaatcagtgagttagtgtcttcagatgtccactgaatcactcattcttttgaagcaaaatctataatacacgaaatatctttgttgtaactgaagacaactaagtaacgagaagcagaaaatgtcctctcaccacccacatcttgccccaggtgacctgagaaattgcatcttgtagaaggaaggcaacatgttacttacatgccccagggaggggggtaacccgggattctccctttctcgtgtaacattcagccgagctacctggacatactccaaacatgtcatgattttagattttgtataaaaatactcccaaagatacagcctcgctcaaagccaggatccacctcccgaggactgacagagagaggatgcctccggcccagagcccacagcagaggcctcactcacgtgcgctctgggccagagcaggcctcaggcacttcagctccagggagaccggccagcaaggtcgggtatttggaaggagctcaggaagcgttcccctgcaggaagccgaaagcaggagagacaccaggggccgggagatggaattggaatctgcagcattcttcaggggcggaagccccaagccgtccatgtgaggctgttggccaaggggctgaggggagggcacgaagtaactcactagagacaagacacaggtgagtcctccaggcacccactcacaggaacagcgtgaaggtcagctttcagaaacttcagtaattttaaaaggatctgaagaggactttaaaaatatctaagatccttaaagggatctggtgggaagagactccacaaaaacacacaggacatgatgaggtgaggagtgcaaatcagggcctaattgctgatgactcaactgcaaaaataaatattttctcaaaggcaatgaaatagcattttcacaggactcaggaaaaatgactcaacctagaattctatacccacataaaatatcttccagtagagaaagttaattgcagcattttcgggtagggaaactgaatttaaaacctgcaagcactgatgaaaggtttattaatacacgtagttcagcagaagaaaacagccttcaggaataagagggaaaacagccgaagctctcagcaaaatggccttgtaagctcttggcaaagctgatttctatgtcttatttgttaagggggaacgtacatttcaggtatcccaggtgcagaagaccgaggggttccaaggagggttaaactgtggcaagaccctttgttgaaaggagagcagagataatgaataactcaaaactttgtaagataatataaaattgaatagcatactaagatgtttaggtaatctttaataggatgtaaaactataaacatccaaacatccttcaaagggaatgagctaaagagataaaacttttccgttccaacacaagccagaagaagggaagaggagaaaaacaaagcaaagtaagaatagaatgcaaattaaaattattctaattgaatcaatagtcacaataaatacacggagagttatcttaccttgtacaagacagaggttaggagattgaaatttaaaatccagttttatgctgtttatgggggacattcttaaaacaaagaaacaatttgaaactaagaggaagggaaatgatagtgaaactctgatataccaatattaatatcaaataactaaaatatctggtaatcacactaacaggtaagagggtattaagagttgagttgtgtcctgttccccagaaaaaggatatgttgaaattctaaccctcagtacttcaaaatgtggtaatatttaaaattgtatttgattgtttggaactatattattatttggaaatagagttttcacagataaccaagctaaaacgaggtcacatgcgtgtctggatccagcgtgacaaaagtatttatttctgcagatgaatcatcagcaattaggccctgatttgcactcctcacctcatcatgtcctgtgtgtttttgtggagtctcttcccaccagatccctttaaggatcttagatatttttaaagtcctcttcagatccttttaaaattactgaagtttctgaaagctgaccttcacgctgttcctgtgagtgggtgcctggaggactcacctgtgtcttgtctctagtgagttacttcgtgccctcccctcagccccttggccaacagcctcacatggacggcttggggcttccgcccctgaagaatgctgcagattccaattccatctcccggcccctggtgtctctcctgctttcggcttcctgcaggggaacgcttcctgagctccttccaaatacccgaccttgctggccggtctccctggagctgaagtgcctgaggcctgctctggcccagagcgcatgtgagtgaggcctctgctgtgggctctgggccggaggcgtcctctctctgtcagtcctcgggaggtggatcctggctttgagcgaggctgtatctttgagaatatttttatacaaaatctaaaatcacgacatgtttggagtatgtccagtaggtcggctcaatgttacactagaaagggagaatccgtgggtgcagacaggtgctgcgggaggaggatgtggaggcagcgggtcgccgggaccaccaggagctagagagaggccggagcagaccccgccccgggcctgtggagggagccaggccctgccccgcagcacctgcgttttggctctggcctccggaactgtgagagaagagatttctgtgaagacaccggctctggggtgctttgctctggcagcagtaggaagccagcgcagagatcagtatgatgcgtctatttaacagcgtccccgcagaatgtgcagaggaaactccagaatgcaaaagtcgggaggtgacagagggagaaggtttacctataacttcttgcgcaaaaacataaattgcaaattaacaacaacaagaggtatggttgaacggcacgattctgagcttgattgatgtgtgtgtcagaaggcaggcctctgcgtgagtagacactgaacacggtttccacgcggtgtattaaacggcccttgcaaatgcctcacagtaacagtgacttgggcaagagaaacccatggaggcaaaacctagtggatgaaagtttcacgagaaacgaggtattaaaatcatctcaagccacttgccgccgtttcgcacctgtaggcccttttccgagtgatagcactgcccagtcgcattcgcgtgccatgggcaccatgtggttctgtggggtgtgccaagggccctgcaccagtctcagtcccctgcacctaaacaccaggacatcagcagagcccgggtgagaggaagctgaccccggaactggcctgcaagcctctgagatgccagcaactgcagagttcacatctgtttgcctggggttgtcagagaacaaagccccagcagaggtcatttcaaggtcatgggaggaaagggaagaccaagccaccattccaggcagaaggaaactggccgtgacaagacatggaatgcatggtcctgagtcaggggctgtgcagaaagaaggggatggaccgacggctgctgcaggtctggttggctggtgggtttcgggtttccctataagtgctatggaaaccacctacggtatgccagcagggcctgtgactcgatggtagtatcgcgtccacgttgatcgctttggggtactgggattacgtggctgtaagtccaggttttagaaatgagagccacatctgccacccttggctgttattcacaagtcatgaatcgaggcagccgccattctttttgtttttttttttttttaattttactttaagctctggggtccatgtgcagaacgtgcaggtttgctacattaagtatacatgtgccacggtggtttgctgcacctgtcaacccaacatgctggttttaaccccgcatgaattagatatttgtcctaatgctctcccttccctttcgccccacacaccgacaggccccggtgtgtgatgttcccctccctgcgtccatgtgttctccttgttcaactcccacttatgagtgagaacatgcagtgtttggttttctgctccgaggaagcctctattctacaagatagaatgagagttccactgggcgctggcagaacagtgggttttgtaaggtggggaccaggaaacagaataggaaacaaaaatgacgggtaacctcaggttacttcaggttcccctttcccttacagggaaaagcagaaggggcttcctttctgcgctgactcaggtctggaatctcctgtggtcaggaaaatctggactgttttgtgatctagatgcttccttaatgtttcagcttgacttagcgtgagtgactccattttggtttgatctggtctgttgggaccaagtgtaggggctcattccaaaacaatggcctcccacaatttttgtttaacaaggttcaaaaagaataatgaagtgtgtgtgtgccgtgagcgcctgtgctgtgcgagcacacgtatgcacatcagagaaagccagtggatgagacaaatgtggtgaaaagttaacagctgaagatgggcatataggagttctatgcactgtcctctcaccttttctgtaaattagacattatttcaaataaaaaagtcaaataattaaatgcaacaaagtaataagacaatataatataaacattaaaattgatgtgaaaagaatattgaaattggccaaaaagaaagtcttgacaaattccaaagataatatatcatacaaaccatatttgtcagctacagtgaaattatactggcaattaactttaaccaaacaacatcaaatgttcaggaagtaagaaaacacatctctgagttaatcattggttaaagaagaaattacagagtgaattacaaaacatttataactgagtgataatgaaaactctagctatcaaaatttgtgggctgggcgtggtaactcatgcctgtgattctaactgtttgggaggccgagacaggtggatcgcatgagctcaggagtttgagacaagcctgagtaacagagtgagaccccgtatctacgagagatacaaacattagccacgtgtggtggtagacacctgtcgtcccagctactcaggaggctgaggtgggagaatcatctgagcccagggtgttgaggctgcagtgagtcgtgatcaagccactgcactccagccttggttacagagtgagctagaccctgtctcaacaaacaaacaaacaaacaaacaaaaaatttgtaaagtgcaaataggaggtaatcacaggaaaatgaacaccatttgatgtatctattggaaaagaaggcagatgggaaacaaattaatgttcatctcaatatgtcgaagccaggcgcggtggctcacgtctgtaatcccagcactttgggaggctgaggcaggtggttcacctgaggtcaggagttcaagaacagactggccaacatggtaaaacccggtctctactaaaaatacaaaaaaagtaaccgggcgtggtggcaggcacctggaatctcagctactcaggagactgaggcaggagacttgcttgaacccagaaggcagaggttgcaatgagcctagatcgcttcactgcactccagcctgggcaacaagagcaaaactctgcctcagaaaagaaaagaaaagaaaaaaaaattggaaaaaatagatgcttttcctcaatcatctgattagcttctgacagcaatgctgaacagaaacaagactgtggcagggaggcttcggcgcgtacatctcgtctgacagggatgcaaatattccatttctctccttgccttggtttctcagctcagcccacatgtgtttttcctgtgggacaggtcccttctgcacacattttgttcaccaacagcagcttaagctttatcttttttcttctgaattcttgttctacttgtactgattttctaatttatttgtttttatcctaggatattttgtaagctatgaaacagttttatatgagactgccattgactgaggaaaaaaatgtgactttgacagaaaagtactccataaatatttgttaaatgcaaatgagccacactaattaagtcaggaaatgataaaagaacttgccacattattatttttcattctttagttatcagcacctttaattgctacctctgagaatcttcatgtaacttctctaagagaaaatatggaaagacttataaagctagtgtgtgttttcacaaatcaaattttcaggactcactttggcccaagttaagcaatgctaagtcatgaatgatttctaagaaccctctgaacactgccttatttgcgtggcctaaatggggctgaataaacgttgcaaccagctttccctcaaatgtccccatgatgttttgagcattgtgaatgcaccaagtcctcacacacgtttcattaggcagcatctctctgccccttaatctttaaatgcaagtgggtttcaaaggaaattatgattcatatgtttctaattcctttattcttactgaaatgtatctaaatattgctttgtaatagttatctgatgcccaaaagcttttgaaattttaactattttcccaaagtcagggtcttatgtttggaaaaacaatgagctctaaaccctacatatttcaactctgaactcatgaggtttcagatgacttttctacatgagcaaatgccattctctacaaatatctgaggattaaatcaataaattcccttttttttccccatggcagtaggtaaggaagaagagattcagaggaagaagagggcctcttagttttgttttaagacattgcaatagtttgggtgaaaagaaaatagagagtagtttgagccactctgtgtgatctcgttgggcctagaatggtgatgg'
#     consensus_padding=consensus_class.ConsensusPadding(
#         sequence='',
#         readname_left='f7ada504-4c28-4be8-8bb5-1d17f4888286',
#         readname_right='a4c08354-027f-4cf0-8534-777467668ca1',
#         padding_size_left=31691,
#         padding_size_right=24725,
#         consensus_interval_on_sequence_with_padding=(31691, 42777)),
#     intervals_cutread_alignments=[(0, 10097, 'f7ada504-4c28-4be8-8bb5-1d17f4888286', True),
#                                   (761, 11086, 'ef0d336d-ea8f-4489-aa8a-c7da86133a36', False),
#                                   (1838, 11073, 'd4f7ea49-305d-4fa0-9221-428922d60591', False),
#                                   (2191, 10973, 'af009bf3-8fd5-47ea-8f5e-d71595f72b7d', True),
#                                   (3340, 11080, '8782cefd-4a2c-4908-bf28-5d946f3163e7', True),
#                                   (4455, 11067, 'aa6212dc-3ebe-4964-a522-8f987863c000', True),
#                                   (4525, 5885, 'c719dee5-9997-4f73-b933-cc56d1043a43', False),
#                                   (4750, 5641, '800ed304-2134-49fd-9a24-b93f26713816', True),
#                                   (4750, 5437, '1fbfd7ac-d2da-478e-9941-eb39a3303870', True),
#                                   (4850, 11081, 'a4c08354-027f-4cf0-8534-777467668ca1', True)],
#     cut_read_alignment_signals=[
#         ReadAlignmentSignals(samplename='HG002', read_name='f7ada504-4c28-4be8-8bb5-1d17f4888286', reference_name='11.0', alignment_forward=True, SV_signals=[SVsignal(ref_start=2550, ref_end=2570, read_start=2519, read_end=2519, size=20, sv_type=1)]), ReadAlignmentSignals(samplename='HG002', read_name='ef0d336d-ea8f-4489-aa8a-c7da86133a36', reference_name='11.0', alignment_forward=False, SV_signals=[SVsignal(ref_start=2550, ref_end=2571, read_start=8457, read_end=8457, size=21, sv_type=1)]), ReadAlignmentSignals(samplename='HG002', read_name='d4f7ea49-305d-4fa0-9221-428922d60591', reference_name='11.0', alignment_forward=False, SV_signals=[]), ReadAlignmentSignals(samplename='HG002', read_name='af009bf3-8fd5-47ea-8f5e-d71595f72b7d', reference_name='11.0', alignment_forward=True, SV_signals=[]), ReadAlignmentSignals(samplename='HG002', read_name='8782cefd-4a2c-4908-bf28-5d946f3163e7', reference_name='11.0', alignment_forward=True, SV_signals=[]), ReadAlignmentSignals(samplename='HG002', read_name='aa6212dc-3ebe-4964-a522-8f987863c000', reference_name='11.0', alignment_forward=True, SV_signals=[]), ReadAlignmentSignals(samplename='HG002', read_name='c719dee5-9997-4f73-b933-cc56d1043a43', reference_name='11.0', alignment_forward=False, SV_signals=[]), ReadAlignmentSignals(samplename='HG002', read_name='800ed304-2134-49fd-9a24-b93f26713816', reference_name='11.0', alignment_forward=True, SV_signals=[]), ReadAlignmentSignals(samplename='HG002', read_name='1fbfd7ac-d2da-478e-9941-eb39a3303870', reference_name='11.0', alignment_forward=True, SV_signals=[]), ReadAlignmentSignals(samplename='HG002', read_name='a4c08354-027f-4cf0-8534-777467668ca1', reference_name='11.0', alignment_forward=True, SV_signals=[])], clustering_meta_data={})

# 67502 = 31691 + 11086 + 24725
